(()=>{var _=document.querySelector("#infinity_point"),w=document.querySelector("#sort_by"),E=document.querySelector("#show"),q=document.querySelectorAll(".filter-form"),I=document.querySelectorAll(".paginate_link[data-url]"),{loading:C,createUrl:y,hiddenLoading:v,getApi:f,appendProduct:A,setProduct:m,updateCount:U,updatePointInfinity:P,updatePaginate:S}=T();if(_){let c=new IntersectionObserver(u=>{u.forEach(e=>{if(e.isIntersecting){let s=function(o){o.set("section_id",t)};var l=s;let a=e.target,n=a.dataset.url,t=a.dataset.sectionId,i=y(s,n.split("?")[1]);C(a),f(i).then(o=>{let p=o.getPointInfinity();A(o.getElementProduct()),P(p),p.dataset.url||c.disconnect()}).finally(()=>{v(a)})}})});c.observe(_)}w&&w.addEventListener("change",c=>{let u=c.target.value,e=c.target.dataset.sectionId;function l(n){n.set("sort_by",u)}let a=y(l,window.location.href.split("?")[1]);history.pushState(null,null,a),f(a).then(n=>{m(n.getElementProduct())})});E&&E.addEventListener("change",c=>{let u=c.target.value,e=c.target.dataset.sectionId,l=`${window.Shopify.routes.root}cart/update.js`,a={attributes:{items_per_page:u},sections:[e]},n={method:"POST",body:JSON.stringify(a),headers:{"Content-Type":"application/json"}};function t(o){return o.json().then(p=>p.sections[e])}function s(o){o.set("items_per_page",u)}let i=y(s,window.location.href.split("?")[1]);history.pushState(null,null,i),f(l,n,t).then(o=>{m(o.getElementProduct()),P(o.getPointInfinity()),S(o.getPaginate())})});q&&q.forEach(c=>{c.addEventListener("submit",n=>{n.preventDefault();let t="",s=new FormData(n.target);for(let[i,o]of s)o!==""&&(t+=`&${i}=${o}`);t=t.replace("&","?"),f(t).then(i=>{m(i.getElementProduct()),U(i.getProductCount()),P(i.getPointInfinity()),S(i.getPaginate())})});let u=document.querySelectorAll('input[type="checkbox"]'),e={},l=new URLSearchParams(window.location.search),a=new URLSearchParams;l.forEach((n,t)=>{e[t]||e[t].push(n),e[t].push(n)}),console.log(e),u.forEach(n=>{n.addEventListener("change",t=>{t.target.checked?(e[t.target.name]||(e[t.target.name]=[]),e[t.target.name].push(t.target.value)):e[t.target.name]&&(e[t.target.name]=e[t.target.name].filter(i=>i!==t.target.value)),Object.keys(e).forEach(i=>{e[i].forEach(o=>{a.append(i,o)})});let s=`${window.location.pathname}?${a.toString()}`;history.pushState(null,null,s)})})});I&&I.forEach(c=>{c.addEventListener("click",u=>{let e=u.target,l=e.dataset.url,a=e.dataset.sectionId;function n(s){s.set("section_id",a)}let t=y(n,l.split("?")[1]);f(t).then(s=>{m(s.getElementProduct()),S(s.getPaginate())})})});function T(){let c=document.querySelector("#collection__products"),u=document.querySelector(".product_count"),e=document.querySelector("#infinity_point"),l=document.querySelector(".paginate");function a(r){r.innerHTML="Loading..."}function n(r){r.innerHTML=""}function t(r,d){let g=new URLSearchParams(d);return r(g),window.location.pathname+"?"+g.toString()}function s(r,d,g){return fetch(r,d).then(h=>g?.(h)??h.text()).then(h=>k(h))}function i(r){r.querySelectorAll("#collection__products > *")?.forEach(d=>{c?.appendChild(d)})}function o(r){c&&(c.parentNode.replaceChild(r,c),c=document.querySelector("#collection__products"))}function p(r){u&&(u.parentNode.replaceChild(r,u),u=document.querySelector(".product_count"))}function b(r){e&&e.setAttribute("data-url",r.dataset.url)}function L(r){l&&(l.parentNode.replaceChild(r,l),l=document.querySelector(".paginate"))}function k(r){let d=document.createElement("div");return d.innerHTML=r,{getElementProduct(){return d.querySelector("#collection__products")},getProductCount(){return d.querySelector(".product_count")},getPointInfinity(){return d.querySelector("#infinity_point")},getPaginate(){return d.querySelector(".paginate")}}}return{loading:a,hiddenLoading:n,getApi:s,appendProduct:i,setProduct:o,updateCount:p,updatePointInfinity:b,createUrl:t,updatePaginate:L}}})();
